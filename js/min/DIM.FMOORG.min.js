
$("#btn-cancelar-orgao").on("click",function(){limpaCamposOrgao()});$(".link-gerenciar-orgao").on("click",function(){atualizaTabelaCombo(0);comboCliente("orgao","01",0,0);$("#orgao-img-captcha").attr("src","/pf/vendor/huge/tools/showCaptcha.php");limpaCamposOrgao()});$("#orgao_id_cliente").on("change",function(){atualizaTabelaCombo($(this).val())});function atualizaTabelaCombo(c){var b=$("#addOrgao").empty().get(0);$("#orgao-superior").empty();var a=$("#orgao-superior");$.post("/pf/DIM.Gateway.php",{arq:93,icl:c,tch:1,sub:-1,dlg:1},function(d){if(d.length>0){for(x=0;x<d.length;x++){insereLinhaOrgao(b,d[x].id,d[x].descricao,d[x].is_ativo,d[x].is_editavel);a.append('<option value="'+d[x].id+'" '+selected+(d[x].is_ativo==0?" disabled":"")+">"+d[x].descricao+"</option>")}}},"json")}$("#btn-salvar-orgao").on("click",function(){if($("#orgao-txt-captcha").val().length<4){swal({title:"Alerta",text:"As letras da imagem est&atilde;o diferentes do que foi digitado, ou n&atilde;o est&atilde;o completas.",type:"error",html:true,confirmButtonText:"Vou corrigir, obrigado!"});return false}else{if($("#orgao-sigla").val()===""){swal({title:"Alerta",text:"Por favor, preencha a sigla do &Oacute;rg&atilde;o.",type:"error",html:true,confirmButtonText:"Entendi, obrigado!"});return false}else{if($("#orgao-descricao").val()===""){swal({title:"Alerta",text:"Por favor, preencha a descri&ccedil;&atilde;o do &Oacute;rg&atilde;o.",type:"error",html:true,confirmButtonText:"Entendi, obrigado!"});return false}else{if($("#orgao-superior").val()==0||!$("#orgao-superior").val()){swal({title:"Alerta",text:"Por favor, selecione o &Oacute;rg&atilde;o superior.",type:"error",html:true,confirmButtonText:"Entendi, obrigado!"});return false}}}}var e=$("#orgao-sigla").val();var b=$("#orgao-descricao").val();var f=$("#orgao-is-ativo").prop("checked")?1:0;var a=1;var d=$("#orgao-superior").val();var c=$("#orgao_id_cliente").val();$.post("/pf/DIM.Gateway.php",{sigla:e,descricao:b,isAtivo:f,idSuperior:d,isEditavel:a,idCliente:c,arq:85,tch:0,sub:-1,dlg:1},function(g){if(g.id>0){swal({title:"Informa&ccedil;&atilde;o",text:"O &Oacute;rg&atilde;o foi inserido com sucesso.",type:"success",html:true,confirmButtonText:"Obrigado!"});atualizaTabelaCombo($("#orgao_id_cliente").val())}else{swal({title:"Alerta",text:"Houve um erro durante a inser&ccedil;&atilde;o do &Oacute;rg&atilde;o, por favor entre em contato com o Administrador do sistema.",type:"error",html:true,confirmButtonText:"Ok, vou verificar!"})}limpaCamposOrgao()},"json")});$("#btn-atualizar-orgao").on("click",function(){if($("#orgao-txt-captcha").val().length<4){swal({title:"Alerta",text:"As letras da imagem est&atilde;o diferentes do que foi digitado ou n&atilde;o est&atilde;o completas.",type:"error",html:true,confirmButtonText:"Vou corrigir, obrigado!"});return false}var d=$("#orgao-id").val();var b=$("#orgao-sigla").val();var a=$("#orgao-descricao").val();var c=$("#orgao-is-ativo").prop("checked")?1:0;$.post("/pf/DIM.Gateway.php",{id:d,sigla:b,descricao:a,isAtivo:c,arq:84,tch:0,sub:-1,dlg:1},function(){swal({title:"Informa&ccedil;&atilde;o",text:"O &Oacute;rg&atilde;o foi atualizado com sucesso.",type:"success",html:true,confirmButtonText:"Obrigado!"});var e=c==1?"checked":"";$("#descricao_"+d).html(b+"."+a);$("#status_"+d).html('<input id="chk-status-'+d+'" onchange="alteraStatusOrgao($(this).val(), $(this).prop(\'checked\'));" value="'+d+'" type="checkbox" data-toggle="toggle" data-width="60" data-onstyle="success" data-offstyle="warning" data-style="slow" data-on="Ativo" data-off="Inativo" data-height="22" class="datatoggle" '+e+">");$(".datatoggle").bootstrapToggle();limpaCamposOrgao()},"json")});$("#orgao-txt-captcha").on("keyup",function(){verificaCaptcha($(this),$("#orgao-i-captcha"),false)});function insereLinhaOrgao(k,c,g,d,f){var a=k.insertRow(-1);var j=a.insertCell(0);var i=a.insertCell(1);var h=a.insertCell(2);var b=d==1?"checked":"";var e=f==1?"":"disabled";i.id="descricao_"+c;h.id="status_"+c;j.innerHTML='<a href="#" onclick="swal(\'Neste momento não é possivel alterar um órgão, apenas desativar\'); return false;'+(f==1?"exibeOrgaoAlteracao("+c+", "+d+");":"return false;")+'">#'+("000000"+c).slice(-6)+"</a>";i.innerHTML=g;h.innerHTML='<input id="chk-status-'+c+'" onchange="'+(f==1?"alteraStatusOrgao($(this).val(), $(this).prop('checked'));":"return false;")+'" value="'+c+'" type="checkbox" data-toggle="toggle" data-width="80" data-onstyle="success" data-offstyle="warning" data-style="slow" data-on="Ativo" data-off="Inativo" class="datatoggle" '+b+" "+e+">";$(".datatoggle").bootstrapToggle()}function exibeOrgaoAlteracao(b,a){$("#orgao-sigla").val($("#sigla_"+b).html());$("#orgao-descricao").val($("#descricao_"+b).html());$("#btn-salvar-orgao").prop("disabled",true);$("#btn-atualizar-orgao").prop("disabled",false);$("#btn-cancelar-orgao").prop("disabled",false);$("#orgao-is-ativo").bootstrapToggle(a?"on":"off");$("#orgao-id").val(b)}$("#fechar-orgao").on("click",function(){limpaCamposOrgao()});$("#btn-cancelar-orgao").on("click",function(){limpaCamposOrgao()});$("#btn-novo-orgao").on("click",function(){$("#btn-salvar-orgao").prop("disabled",false);limpaCamposOrgao()});function limpaCamposOrgao(){var a=$("#orgao-id").val();$("#orgao-sigla").val("");$("#orgao-descricao").val("");$("#orgao-superior").val(0);$("#btn-salvar-orgao").prop("disabled",false);$("#btn-atualizar-orgao").prop("disabled",true);$("#btn-cancelar-orgao").prop("disabled",true);$("#chk-status-"+a).bootstrapToggle("enable");$("#orgao-id").val(0);$("#orgao-is-ativo").bootstrapToggle("enable").bootstrapToggle("on");$("#orgao-txt-captcha").val("");$("#orgao-superior").empty()}function alteraStatusOrgao(b,a){iWait("w_orgao_status",true);if($("#orgao-id").val()!=0&&$("#orgao-id").val()===b){$("#orgao-is-ativo").bootstrapToggle("enable").bootstrapToggle(a?"on":"off").bootstrapToggle("disable")}$.post("/pf/DIM.Gateway.php",{i:b,p:a?1:0,arq:86,tch:0,sub:-1,dlg:1},function(c){if(!(c.status)){gravaLogAuditoria(emailLogado,userRole,"alterar-status-orgao;"+("000000000"+idEmpresa).slice(-9))}iWait("w_orgao_status",false)},"json");setSelectedFromValue("orgao-superior",b);console.log(b);if(a){$("#orgao-superior").find("option:selected").css("color","#000").prop("disabled",false)}else{$("#orgao-superior").find("option:selected").css("color","#f0f0f0").prop("disabled",true)}setNoneSelected("orgao-superior")};