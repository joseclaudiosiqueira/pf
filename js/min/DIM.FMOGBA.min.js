
$("#btn-cancelar-baseline").on("click",function(){limpaCamposBaseline(false)});$(".money").mask("###0.00",{reverse:true});$("#link-gerenciar-baseline").on("click",function(){comboCliente("baseline",0,"01",idFornecedor);limpaCamposBaseline(true)});$("#baseline_id_cliente").on("change",function(){if(Number($(this).val())!==0){var a=$("#addBaseline").empty().get(0);var b=$("#baseline_id_cliente option:selected").val();$.post("/pf/DIM.Gateway.php",{arq:30,tch:1,sub:-1,dlg:1,icl:b},function(c){if(c.length>0){for(x=0;x<c.length;x++){insereLinhaBaseline(a,c[x].id,c[x].sigla,c[x].descricao,c[x].resumo,c[x].valor_pf,c[x].valor_hpa,c[x].valor_hpc,c[x].is_ativo)}}},"json")}else{limpaCamposBaseline(true)}});$("#btn-salvar-baseline").on("click",function(){if($("#baseline-txt-captcha").val().length<4){swal({title:"Alerta",text:"As letras da imagem est&atilde;o diferentes do que foi digitado, ou n&atilde;o est&atilde;o completas.",type:"error",html:true,confirmButtonText:"Vou corrigir, obrigado!"});return false}else{if(Number($("#baseline_id_cliente option:selected").val())===0){swal({title:"Alerta",text:"Por favor, selecione um Cliente para a Baseline.",type:"error",html:true,confirmButtonText:"Entendi, obrigado!"});return false}else{if($("#baseline-sigla").val()===""){swal({title:"Alerta",text:"Por favor, preencha a sigla da Baseline.",type:"error",html:true,confirmButtonText:"Entendi, obrigado!"});return false}else{if($("#baseline-descricao").val()===""){swal({title:"Alerta",text:"Por favor, preencha a descri&ccedil;&atilde;o da Baseline.",type:"error",html:true,confirmButtonText:"Entendi, obrigado!"});return false}else{if($("#baseline-resumo").val()===""){swal({title:"Alerta",text:"Por favor, preencha um resumo sobre a Baseline.",type:"error",html:true,confirmButtonText:"Entendi, obrigado!"});return false}else{if($("#baseline-valor-pf").val()===""){swal({title:"Alerta",text:"Por favor, para efeitos estat&iacute;sticos, preencha um valor para os Pontos de Fun&ccedil;&atilde;o.",type:"error",html:true,confirmButtonText:"Entendi, obrigado!"});return false}else{if($("#baseline-valor-hpc").val()===""){swal({title:"Alerta",text:"Por favor, para efeitos estat&iacute;sticos, preencha um valor para valor das Horas de Consultor.",type:"error",html:true,confirmButtonText:"Entendi, obrigado!"});return false}else{if($("#baseline-valor-hpc").val()===""){swal({title:"Alerta",text:"Por favor, para efeitos estat&iacute;sticos, preencha um valor para valor das Horas de Analista.",type:"error",html:true,confirmButtonText:"Entendi, obrigado!"});return false}}}}}}}}var h=$("#baseline_id_cliente option:selected").val();var c=$("#baseline-sigla").val();var b=$("#baseline-descricao").val();var g=$("#baseline-resumo").val();var a=$("#baseline-valor-pf").val();var f=$("#baseline-valor-hpa").val();var d=$("#baseline-valor-hpc").val();var e=$("#baseline-is-ativo").prop("checked")?1:0;$.post("/pf/DIM.Gateway.php",{icl:h,sigla:c,descricao:b,resumo:g,valorPf:a,valorHpa:f,valorHpc:d,isAtivo:e,arq:24,tch:0,sub:-1,dlg:1},function(i){if(i.id>0){swal({title:"Informa&ccedil;&atilde;o",text:"A Baseline foi inserida com sucesso.",type:"success",html:true,confirmButtonText:"Obrigado!"});var j=$("#addBaseline").get(0);insereLinhaBaseline(j,i.id,c,b,g,a,f,d,e)}else{swal({title:"Alerta",text:"Houve um erro durante a inser&ccedil;&atilde;o da Baseline, por favor entre em contato com o Administrador do sistema.",type:"error",html:true,confirmButtonText:"Ok, vou verificar!"})}},"json");limpaCamposBaseline(false)});$("#btn-atualizar-baseline").on("click",function(){if($("#baseline-txt-captcha").val().length<4){swal({title:"Alerta",text:"As letras da imagem est&atilde;o diferentes do que foi digitado ou n&atilde;o est&atilde;o completas.",type:"error",html:true,confirmButtonText:"Vou corrigir, obrigado!"});return false}var h=$("#baseline-id").val();var c=$("#baseline-sigla").val();var b=$("#baseline-descricao").val();var g=$("#baseline-resumo").val();var a=$("#baseline-valor-pf").val();var f=$("#baseline-valor-hpa").val();var d=$("#baseline-valor-hpc").val();var e=$("#baseline-is-ativo").prop("checked")?1:0;$.post("/pf/DIM.Gateway.php",{id:h,sigla:c,descricao:b,resumo:g,valorPf:a,valorHpa:f,valorHpc:d,isAtivo:e,arq:10,tch:0,sub:-1,dlg:1},function(){swal({title:"Informa&ccedil;&atilde;o",text:"A Baseline foi atualizada com sucesso.",type:"success",html:true,confirmButtonText:"Obrigado!"});var i=e==1?"checked":"";$("#sigla_"+h).html(c);$("#descricao_"+h).html(b);$("#resumo_"+h).html(g);$("#pf_"+h).html(parseFloat(a).toFixed(2));$("#hpa_"+h).html(parseFloat(f).toFixed(2));$("#hpc_"+h).html(parseFloat(d).toFixed(2));$("#status_"+h).html('<input id="chk-status-'+h+'" onchange="alteraStatusBaseline($(this).val(), $(this).prop(\'checked\'));" value="'+h+'" type="checkbox" data-toggle="toggle" data-size="mini" data-width="60" data-onstyle="success" data-offstyle="warning" data-style="slow" data-on="Ativa" data-off="Inativa" class="datatoggle" '+i+">");$(".datatoggle").bootstrapToggle();limpaCamposBaseline(false)},"json")});$("#baseline-txt-captcha").on("keyup",function(){verificaCaptcha($(this),$("#baseline-i-captcha"),false)});function insereLinhaBaseline(g,q,b,p,s,u,n,j,a){var l=g.insertRow(-1);var o=l.insertCell(0);var m=l.insertCell(1);var k=l.insertCell(2);var i=l.insertCell(3);var h=l.insertCell(4);var f=l.insertCell(5);var e=l.insertCell(6);var d=l.insertCell(7);var c=a==1?"checked":"";m.id="sigla_"+q;k.id="descricao_"+q;i.id="resumo_"+q;h.id="pf_"+q;f.id="hpa_"+q;e.id="hpc_"+q;d.id="status_"+q;o.innerHTML='<a href="#" onclick="exibeBaselineAlteracao('+q+", "+a+');">#'+("000000"+q).slice(-6)+"</a>";m.innerHTML=b;k.innerHTML=p;i.innerHTML=s;h.innerHTML=parseFloat(u).toFixed(2);f.innerHTML=parseFloat(n).toFixed(2);e.innerHTML=parseFloat(j).toFixed(2);d.innerHTML='<input id="chk-status-'+q+'" onchange="alteraStatusBaseline($(this).val(), $(this).prop(\'checked\'));" value="'+q+'" type="checkbox" data-toggle="toggle" data-width="90" data-onstyle="success" data-offstyle="warning" data-style="slow" data-on="Ativa" data-off="Inativa" class="datatoggle" '+c+">";$(".datatoggle").bootstrapToggle()}function exibeBaselineAlteracao(b,a){$("#baseline-sigla").val($("#sigla_"+b).html());$("#baseline-descricao").val($("#descricao_"+b).html());$("#baseline-resumo").val($("#resumo_"+b).html());$("#baseline-valor-pf").val($("#pf_"+b).html());$("#baseline-valor-hpa").val($("#hpa_"+b).html());$("#baseline-valor-hpc").val($("#hpc_"+b).html());$("#btn-salvar-baseline").prop("disabled",true);$("#btn-atualizar-baseline").prop("disabled",false);$("#btn-cancelar-baseline").prop("disabled",false);$("#baseline-is-ativo").bootstrapToggle(a?"on":"off");$("#baseline-id").val(b)}$("#fechar-baseline").on("click",function(){limpaCamposBaseline(true)});$("#btn-nova-baseline").on("click",function(){$("#btn-salvar-baseline").prop("disabled",false);limpaCamposBaseline(false)});function limpaCamposBaseline(a){var c=$("#baseline-id").val();$("#baseline-sigla").val("");$("#baseline-descricao").val("");$("#baseline-resumo").val("");$("#baseline-valor-pf").val("");$("#baseline-valor-hpa").val("");$("#baseline-valor-hpc").val("");$("#btn-salvar-baseline").prop("disabled",false);$("#btn-atualizar-baseline").prop("disabled",true);$("#btn-cancelar-baseline").prop("disabled",true);$("#chk-status-"+c).bootstrapToggle("enable");$("#baseline-id").val(0);$("#baseline-is-ativo").bootstrapToggle("enable").bootstrapToggle("on");$("#baseline-txt-captcha").val("");refreshCaptcha($("#baseline-img-captcha"),$("#baseline-txt-captcha"));a?$("#addBaseline").empty():NULL;return true}function alteraStatusBaseline(b,a){iWait("w_baseline_status",true);if(Number($("#baseline-id").val())!==0&&$("#baseline-id").val()===b){$("#baseline-is-ativo").bootstrapToggle("enable").bootstrapToggle(a?"on":"off").bootstrapToggle("disable")}$.post("/pf/DIM.Gateway.php",{i:b,p:a?1:0,arq:74,tch:0,sub:-1,dlg:1},function(c){if(!(c.status)){gravaLogAuditoria(emailLogado,userRole,"alterar-status-baseline;"+("000000000"+idEmpresa).slice(-9))}iWait("w_baseline_status",false)},"json")};