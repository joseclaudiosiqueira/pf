
RGraph=window.RGraph||{isRGraph:true};RGraph.HTML=RGraph.HTML||{};(function(d,c,e){var b=RGraph,a=navigator.userAgent,f=Math;b.drawKey=b.DrawKey=function(n,v,g){if(!v){return}var l=n.canvas,t=n.context,h=n.properties,j=h["chart.key.position"],s=h["chart.text.size"],q=[],p=[];t.lineWidth=1;t.beginPath();if(typeof(h["chart.key.vpos"])=="number"){n.Set("chart.key.position.y",h["chart.key.vpos"]*h["chart.gutter.top"])}for(var m=0;m<v.length;++m){if(v[m]!=null){p.push(g[m]);q.push(v[m])}}v=q;g=p;function o(I,T,C){var D=typeof(h["chart.key.text.size"])=="number"?h["chart.key.text.size"]:h["chart.text.size"];var z=h["chart.key.text.italic"]?true:false;var H=h["chart.key.text.bold"]?true:false;var B=h["chart.key.text.font"]||h["chart.key.font"]||h["chart.text.font"];var G=I.gutterLeft;var x=I.gutterRight;var S=I.gutterTop;var M=I.gutterBottom;var Q=h["chart.yaxispos"]=="right"?G+10:l.width-x-10;var R=S+10;var U=h["chart.title"];var J=D;var A=8;var E=4;var w=h["chart.key.background"];var y=h["chart.key.text.color"];var F="#333";var K=0;var L=0;if(!I.coords){I.coords={}}I.coords.key=[];t.font=D+"pt "+h["chart.text.font"];for(O=0;O<T.length;++O){L=Math.max(L,t.measureText(T[O]).width)}L+=5;L+=J;L+=5;L+=5;L+=5;if(h["chart.yaxispos"]=="left"||(I.type==="pie"&&!h["chart.yaxispos"])||(I.type==="hbar"&&!h["chart.yaxispos"])||(I.type==="hbar"&&h["chart.yaxispos"]==="center")||(I.type==="hbar"&&h["chart.yaxispos"]==="right")||(I.type==="rscatter"&&!h["chart.yaxispos"])||(I.type==="radar"&&!h["chart.yaxispos"])||(I.type==="rose"&&!h["chart.yaxispos"])||(I.type==="funnel"&&!h["chart.yaxispos"])||(I.type==="vprogress"&&!h["chart.yaxispos"])||(I.type==="hprogress"&&!h["chart.yaxispos"])){Q-=L}if(typeof(h["chart.key.halign"])=="string"){if(h["chart.key.halign"]=="left"){Q=G+10}else{if(h["chart.key.halign"]=="right"){Q=l.width-x-L}}}if(typeof(h["chart.key.position.x"])=="number"){Q=h["chart.key.position.x"]}if(typeof(h["chart.key.position.y"])=="number"){R=h["chart.key.position.y"]}if(h["chart.key.shadow"]){t.shadowColor=h["chart.key.shadow.color"];t.shadowBlur=h["chart.key.shadow.blur"];t.shadowOffsetX=h["chart.key.shadow.offsetx"];t.shadowOffsetY=h["chart.key.shadow.offsety"]}t.beginPath();t.fillStyle=h["chart.key.background"];t.strokeStyle="black";if(typeof(h["chart.key.position.graph.boxed"])=="undefined"||(typeof(h["chart.key.position.graph.boxed"])=="boolean"&&h["chart.key.position.graph.boxed"])){if(arguments[3]!=false){t.lineWidth=typeof(h["chart.key.linewidth"])=="number"?h["chart.key.linewidth"]:1;if(h["chart.key.rounded"]==true){t.beginPath();t.strokeStyle=F;b.strokedCurvyRect(t,Math.round(Q),Math.round(R),L-5,5+((D+5)*b.getKeyLength(T)),4);t.stroke();t.fill();b.NoShadow(I)}else{t.strokeRect(Math.round(Q),Math.round(R),L-5,5+((D+5)*b.getKeyLength(T)));t.fillRect(Math.round(Q),Math.round(R),L-5,5+((D+5)*b.getKeyLength(T)))}}}b.NoShadow(I);t.beginPath();if(h["chart.key.colors"]){C=h["chart.key.colors"]}for(var O=T.length-1;O>=0;O--){var N=Number(O)+1;if(typeof(h["chart.key.color.shape"])=="object"&&typeof(h["chart.key.color.shape"][O])=="string"){var P=h["chart.key.color.shape"][O]}else{if(typeof(h["chart.key.color.shape"])=="string"){var P=h["chart.key.color.shape"]}else{var P="square"}}if(P=="circle"){t.beginPath();t.fillStyle=C[O];t.arc(Q+5+(J/2),R+(5*N)+(D*N)-D+(J/2),J/2,0,6.26,0);t.fill()}else{if(P=="line"){t.beginPath();t.strokeStyle=C[O];t.moveTo(Q+5,R+(5*N)+(D*N)-D+(J/2));t.lineTo(Q+J+5,R+(5*N)+(D*N)-D+(J/2));t.stroke()}else{if(P=="triangle"){t.beginPath();t.strokeStyle=C[O];t.moveTo(Q+5,R+(5*N)+(D*N)-D+J);t.lineTo(Q+(J/2)+5,R+(5*N)+(D*N)-D);t.lineTo(Q+J+5,R+(5*N)+(D*N)-D+J);t.closePath();t.fillStyle=C[O];t.fill()}else{t.fillStyle=C[O];t.fillRect(Q+5,R+(5*N)+(D*N)-D,D,D+1)}}}t.beginPath();t.fillStyle=typeof y=="object"?y[O]:y;ret=b.Text2(I,{font:B,size:D,bold:H,italic:z,x:Q+J+5+5,y:R+(5*N)+(D*N)+3,text:T[O]});I.coords.key[O]=[ret.x,ret.y,ret.width,ret.height,T[O],C[O],I]}t.fill()}function u(K,T,E){var G=typeof(h["chart.key.text.size"])=="number"?h["chart.key.text.size"]:h["chart.text.size"],J=h["chart.key.text.bold"],B=h["chart.key.text.italic"],D=h["chart.key.text.font"]||h["chart.key.font"]||h["chart.text.font"],z=h["chart.key.text.color"],I=K.gutterLeft,x=K.gutterRight,R=K.gutterTop,M=K.gutterBottom,P=((l.width-I-x)/2)+K.gutterLeft,Q=R-G-5,U=h["chart.title"],L=G,C=8,F=4,w=h["chart.key.background"],H="#999",y=0;if(!K.coords){K.coords={}}K.coords.key=[];t.font=G+"pt "+D;for(N=0;N<T.length;++N){y+=C;y+=L;y+=C;y+=t.measureText(T[N]).width}y+=C;if(K.type=="pie"){if(h["chart.align"]=="left"){var P=K.radius+I}else{if(h["chart.align"]=="right"){var P=l.width-K.radius-x}else{P=l.width/2}}}P-=(y/2);if(typeof(h["chart.key.position.x"])=="number"){P=h["chart.key.position.x"]}if(typeof(h["chart.key.position.y"])=="number"){Q=h["chart.key.position.y"]}if(K.Get("chart.key.position.gutter.boxed")){if(h["chart.key.shadow"]){t.shadowColor=h["chart.key.shadow.color"];t.shadowBlur=h["chart.key.shadow.blur"];t.shadowOffsetX=h["chart.key.shadow.offsetx"];t.shadowOffsetY=h["chart.key.shadow.offsety"]}t.beginPath();t.fillStyle=w;t.strokeStyle=H;if(h["chart.key.rounded"]){b.strokedCurvyRect(t,P,Q-F,y,G+F+F)}else{t.rect(P,Q-F,y,G+F+F)}t.stroke();t.fill();b.NoShadow(K)}if(h["chart.key.colors"]){E=h["chart.key.colors"]}for(var N=0,A=P;N<T.length;++N){A+=C;if(typeof(h["chart.key.color.shape"])=="object"&&typeof(h["chart.key.color.shape"][N])=="string"){var O=h["chart.key.color.shape"][N]}else{if(typeof(h["chart.key.color.shape"])=="string"){var O=h["chart.key.color.shape"]}else{var O="square"}}if(O=="line"){t.beginPath();t.strokeStyle=E[N];t.moveTo(A,Q+(L/2));t.lineTo(A+L,Q+(L/2));t.stroke()}else{if(O=="circle"){t.beginPath();t.fillStyle=E[N];t.moveTo(A,Q+(L/2));t.arc(A+(L/2),Q+(L/2),(L/2),0,6.28,0);t.fill()}else{if(O=="triangle"){t.fillStyle=E[N];t.beginPath();t.strokeStyle=E[N];t.moveTo(A,Q+L);t.lineTo(A+(L/2),Q);t.lineTo(A+L,Q+L);t.closePath();t.fill()}else{t.beginPath();t.fillStyle=E[N];t.rect(A,Q,L,L);t.fill()}}}A+=L;A+=C;t.beginPath();t.fillStyle=typeof z=="object"?z[N]:z;var S=b.Text2(K,{font:D,bold:J,size:G,italic:B,x:A,y:Q+G+3,text:T[N]});t.fill();A+=t.measureText(T[N]).width;K.coords.key[N]=[S.x,S.y,S.width,S.height,T[N],E[N],K]}}if(j&&j=="gutter"){u(n,v,g)}else{if(j&&j=="graph"){o(n,v,g)}else{alert("[COMMON] ("+n.id+") Unknown key position: "+j)}}if(h["chart.key.interactive"]){if(!RGraph.Drawing||!RGraph.Drawing.Rect){alert("[INTERACTIVE KEY] The drawing API Rect library does not appear to have been included (which the interactive key uses)")}if(!RGraph.InstallWindowMousedownListener){alert("[INTERACTIVE KEY] The dynamic library does not appear to have been included")}for(var m=0,r=n.coords.key.length,k=0;m<r;m+=1){k=Math.max(k,n.coords.key[m][2])}for(var m=0,r=n.coords.key.length;m<r;m+=1){(function(w){var i=n.coords.key;var z=n.coords.key[w];var x=w;var y=new RGraph.Drawing.Rect(n.id,z[0],z[1],h["chart.key.position"]=="gutter"?z[2]:k,z[3]).Set("fillstyle","rgba(0,0,0,0)").Draw();y.onclick=function(B,A){var C=y.context;C.fillStyle=h["chart.key.interactive.highlight.label"];C.fillRect(A.x,A.y,A.width,A.height);if(typeof n.interactiveKeyHighlight=="function"){n.Set("chart.key.interactive.index",w);b.FireCustomEvent(n,"onbeforeinteractivekey");n.interactiveKeyHighlight(x);b.FireCustomEvent(n,"onafterinteractivekey")}};y.onmousemove=function(B,A){B.target.style.cursor="pointer"}})(m)}}};b.getKeyLength=function(j){var k=0;for(var h=0,g=j.length;h<g;h+=1){if(j[h]!=null){++k}}return k};RGraph.HTML.key=RGraph.HTML.Key=function(l,k){var j=c.getElementById(l);var h='<table border="0" cellspacing="0" cellpadding="0" id="rgraph_key" style="display: inline;'+(function(){var i="";for(g in k.tableCss){if(typeof g==="string"){i=i+g+": "+k.tableCss[g]+";"}}return i})()+'" '+(k.tableClass?'class="'+k.tableClass+'"':"")+">";for(var g=0;g<k.labels.length;g+=1){h+='<tr><td><div style="'+(function(){var m="";for(var i in k.blobCss){if(typeof i==="string"){m=m+i+": "+k.blobCss[i]+";"}}return m})()+"display: inline-block; margin-right: 5px; margin-top: 4px; width: 15px; height: 15px; background-color: "+k.colors[g]+'"'+(k.blobClass?'class="'+k.blobClass+'"':"")+">&nbsp;</div><td>"+(k.links&&k.links[g]?'<a href="'+k.links[g]+'">':"")+"<span "+(k.labelClass?'class="'+k.labelClass+'"':"")+'" '+(function(){var m="";for(var i in k.labelCss){if(typeof i==="string"){m=m+i+": "+k.labelCss[i]+";"}}return m})()+(function(){var m="";if(k["labelCss_"+g]){for(var i in k["labelCss_"+g]){m=m+i+": "+k["labelCss_"+g][i]+";"}}return m?'style="'+m+'"':""})()+">"+k.labels[g]+"</span>"+(k.links&&k.links[g]?"</a>":"")+"</td></tr>"}j.innerHTML+=(h+"</table>");return c.getElementById("rgraph_key")}})(window,document);