
function consultaFuncaoOutrosBaseline(c,a){$.post("/pf/DIM.Gateway.php",{i:c,b:a,arq:43,tch:1,sub:-1,dlg:1},function(b){var d=Number(b[0].pfa);$("#outros_id").val(ac=="al"?b[0].id:0);$("#outros_entrega").val(b[0].entrega).mask("00").TouchSpin({min:1,max:$("#entregas").val(),step:1,boostat:5,maxboostedstep:10,postfix:""}).prop("readonly",true);$("#outros_qtd").val(b[0].qtd);$("#outros_fonte").val(b[0].fonte);$("#outros_pfa").val(d.toFixed(4));$("#outros_impacto").val(b[0].selImpacto);$("#outros_observacoes").val(b[0].obs_funcao);$("#outros_observacoes_validacao").val(b[0].obs_validar);detalheItem(b[0].selImpacto,"outros")},"json")}function retornaFuncaoOutros(c,a,d,e,f){acForms="al";fAtual=a;$.post("/pf/DIM.Gateway.php",{i:c,b:a,arq:43,tch:1,sub:-1,dlg:1},function(b){$("#form_modal_funcao_outros").modal("toggle");$("#cabecalho_funcao").val(title_ou_alt);$("#outros_h4-modal").html(title_ou_alt);$("#outros_tabela").val("OU");$("#outros_qtd_atual").val(d);$("#outros_id").val(c);$("#outros_id_roteiro").val(b[0].id_roteiro);$("#outros_operacao").val(b[0].operacao);$("#outros_entrega").val(b[0].entrega).mask("00").TouchSpin({min:1,max:$("#entregas").val(),step:1,boostat:5,maxboostedstep:10,postfix:""}).prop("readonly",true);verificaOperacao("outros",b[0].operacao,b[0].id_roteiro,b[0].selImpacto,a,ac);situacaoLinha=b[0].situacao;$("#outros_funcao").val(b[0].funcao);$("#outros_qtd").val(b[0].qtd);$("#outros_fonte").val(b[0].fonte);var g=Number(b[0].pfa);$("#outros_pfa").val(g.toFixed(4));$("#outros_observacoes").val(b[0].obs_funcao);$("#outros_observacoes_validacao").val(b[0].obs_validar);$("#btn-listar-itens-outros").prop("disabled",!1);detalheItem(b[0].selImpacto,"outros");$("#outros_id_funcao_baseline").val(b[0].idBaseline);if(Number(b[0].idBaseline)>0&&b[0].operacao==="I"&&Number(b[0].situacao)==2&&!(ac==="vw"||ac==="vi"||ac==="ve"||ac==="ai"||ac==="ae"||ac==="re")){swal({title:"Alerta",text:"A fun&ccedil;&atilde;o foi inserida nesta contagem, entretanto j&aacute; foi validada na Baseline. Desta forma n&atilde;o &eacute; poss&iacute;vel realizar as altera&ccedil;&otilde;es aqui. Caso seja uma altera&ccedil;&atilde;o solicitada por um outro projeto ou por este mesmo, inclua um novo item como A - Altera&ccedil;&atilde;o ou E - Exclus&atilde;o.",type:"error",html:true,confirmButtonText:"Entendi!"},function(){autorizaAlteracaoCamposLinha(false,"outros")})}else{if((abAtual==3||abAtual==4)&&acForms==="al"&&b[0].idGerador>0){swal({title:"Alerta",text:"Esta fun&ccedil;&atilde;o foi inserida pela contagem<br />#ID: <strong>"+("000000"+b[0].idContagem).slice(-6)+"</strong>. Desta forma n&atilde;o &eacute; poss&iacute;vel realizar as altera&ccedil;&otilde;es aqui.",type:"error",html:true,confirmButtonText:"Entendi!"},function(){autorizaAlteracaoCamposLinha(false,"outros")})}else{$("#outros_btn_if").prop("disabled",true);$("#outros_btn_in").prop("disabled",true);$("#outros_btn_al").prop("disabled",isAutorizadoAlterar?false:true)}}if(ac==="vw"||ac==="vi"||ac==="ve"||ac==="ai"||ac==="ae"){autorizaAlteracaoCamposLinha(false,"outros")}},"json")}function insereFuncaoOutros(a){var d=validaFormFuncao("outros");if(!d.sucesso){swal({title:"Alerta",text:d.msg,type:"error",html:true,confirmButtonText:"Entendi!"});return false}var c=$("#outros_operacao").val();$.post("/pf/DIM.Gateway.php",{outros_operacao:$("#outros_operacao").val(),outros_tabela:$("#outros_tabela").val(),outros_entrega:$("#outros_entrega").val(),outros_id:idContagem,outros_qtd_atual:$("#outros_qtd_atual").val(),outros_id_roteiro:$("#outros_id_roteiro").val(),outros_funcao:(abAtual==2&&(c==="A"||c==="E"))?$("#outros_funcao").children(":selected").text():$("#outros_funcao").val(),outros_qtd:$("#outros_qtd").val(),outros_impacto:$("#outros_impacto").val(),outros_pfa:$("#outros_pfa").val(),outros_observacoes:$("#outros_observacoes").val(),outros_observacoes_validacao:$("#outros_observacoes_validacao").val(),outros_fonte:$("#outros_fonte").val(),funcao_id_baseline:(abAtual==2&&(c==="A"||c==="E"))?$("#outros_funcao").children(":selected").val():0,abrangencia_atual:abAtual,contagem_id_baseline:abAtual==2?$("#contagem_id_baseline").children(":selected").val():0,arq:27,tch:0,sub:-1,dlg:1},function(e){if(Number(e[0].id)>0){var b=document.getElementById("add"+e[0].tabela);var f=b.insertRow(-1);var g=Number(e[0].pfa);insereLinhaOutros(e[0].id,e[0].tabela,f,e[0].operacao,e[0].funcao,e[0].qtd,e[0].siglaFator,g.toFixed(4),e[0].obsFuncao,e[0].situacao,e[0].entrega,0,0,true)}else{swal({title:"Alerta",text:_ERR_INSERCAO,type:"error",html:true,confirmButtonText:"Entendi!"},function(){return false})}},"json");limpaCampos("outros");return true}function alteraFuncaoOutros(a){var d=validaFormFuncao("outros");var c=situacaoLinha==3?3:(situacaoLinha==4?3:(abAtual==3||abAtual==4?2:1));if(!d.sucesso){swal({title:"Alerta",text:d.msg,type:"error",html:true,confirmButtonText:"Entendi!"});return false}else{$.post("/pf/DIM.Gateway.php",{outros_operacao:$("#outros_operacao").val(),outros_tabela:$("#outros_tabela").val(),outros_entrega:$("#outros_entrega").val(),outros_id:$("#outros_id").val(),outros_qtd_atual:$("#outros_qtd_atual").val(),outros_id_roteiro:$("#outros_id_roteiro").val(),outros_funcao:(abAtual==2&&$("#outros_operacao").val()==="I")?$("#outros_funcao").val():$("#outros_funcao").children(":selected").text(),outros_qtd:$("#outros_qtd").val(),outros_impacto:$("#outros_impacto").val(),outros_pfa:$("#outros_pfa").val(),outros_observacoes:$("#outros_observacoes").val(),outros_observacoes_validacao:$("#outros_observacoes_validacao").val(),outros_fonte:$("#outros_fonte").val(),contagem_id_baseline:$("#contagem_id_baseline option:selected").val(),situacao:c,funcao_id_baseline:$("#outros_id_funcao_baseline").val(),acao_forms:acForms,abrangencia_atual:abAtual,id_contagem:idContagem,arq:6,tch:0,sub:-1,dlg:1},function(g){if(Number(g.id)>0){var e=Number(g.pfAnterior);var b=$("#outros_qtd_atual").val();var h=g.tabela;var j=Number(g.pfa);var f=g.obsFuncao;var i=divOperacao(g.operacao);$("#oper_"+h+"_"+b).html(i);$("#funcao_"+h+"_"+b).html(g.funcao);$("#qtd_"+h+"_"+b).html(g.qtd);$("#pfa_"+h+"_"+b).html(j.toFixed(4));$("#siglaFator_"+h+"_"+b).html(g.siglaFator);$("#ent_"+h+"_"+b).html(g.entrega);$("#obs_"+h+"_"+b).html(f);setSituacao(c,"cell1_"+h+"_"+$("#outros_id").val());recalculaEstatisticas(j.toFixed(4),0,"OU","alterar",e,0,true);swal("Dimension","O registro foi alterado com sucesso!","success");$("#form_modal_funcao_outros").modal("toggle");limpaCampos("outros")}else{swal({title:"Alerta",text:g.msg,type:"error",html:true,confirmButtonText:"Entendi!"},function(){$("#form_modal_funcao_outros").modal("toggle");limpaCampos("outros")})}},"json")}};