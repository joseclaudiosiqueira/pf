
var dataFormCliente;$("#fmiacli-txt-captcha").on("keyup",function(){verificaCaptcha($(this),$("#fmiacli-i-captcha"),false)});if(empresaConfigPlano.id<3){$("#cli-inserir").css({"text-decoration":"line-through"})}$("#cli-inserir").on("click",function(){if(!isFornecedor){$("#fmiacli-img-captcha").attr("src","/pf/vendor/huge/tools/showCaptcha.php")}});$("#fmiacli_btn_alterar").on("click",function(){if(!isFornecedor){$("#fmiacli-img-captcha").attr("src","/pf/vendor/huge/tools/showCaptcha.php")}});$("#form_inserir_alterar_cliente").on("submit",function(){var a=$("#fmiacli_acao").val();if($("#fmiacli-txt-captcha").val().length<4){swal({title:"Alerta",text:"As letras da imagem est&atilde;o diferentes do que foi digitado.",type:"error",html:true,confirmButtonText:"Vou corrigir, obrigado!"})}else{$.post("/pf/DIM.Gateway.php",variaveisFormCliente(a),function(b){if(b.id>0){swal({title:"Informa&ccedil;&atilde;o",text:b.msg,type:"success",html:true,confirmButtonText:"Obrigado!"});if(dataFormCliente.acao==="inserir"){$("#fmiacli_id").val(b.id);$("#fmiacli_btn_inserir").prop("disabled",true);$("#fmiacli_btn_novo").prop("disabled",false);$("#fmiacli_btn_atualizar").prop("disabled",false);$("#avatar-frame-cli").contents().find("#avatar_id").val(b.id);comboCliente("combo_alterar",0,"01",(isFornecedor?idFornecedor:0))}else{if(dataFormCliente.acao==="alterar"){comboCliente("combo_alterar",b.id,"01",(isFornecedor?idFornecedor:0));$("#fmiacli_span_descricao").html(b.descricao);$("#fmiacli_span_nome").html(b.nome);$("#fmiacli_span_email").html('<a href="mailto:'+b.email+'">'+b.email+"</a>");$("#fmiacli_span_telefone").html(b.telefone);$("#fmiacli_is_ativo").prop("checked")?$("#div-txt-cliente").html("Atualmente o cliente est&aacute; <kbd>ativo</kbd>"):$("#div-txt-cliente").html("Atualmente o cliente est&aacute; <kbd>inativo</kbd>")}}}$("#fmiacli-i-captcha").removeClass("fa-check-circle").addClass("fa-dot-circle-o");$("#fmiacli-txt-captcha").val("");$("#fmiacli-img-captcha").attr("src","/pf/vendor/huge/tools/showCaptcha.php")},"json")}return false});$("#fechar_cliente").on("click",function(){limpaCamposCliente();return true});$("#fmiacli_btn_novo").on("click",function(){limpaCamposCliente();return true});$("#combo_alterar_id_cliente").on("change",function(){if($("#combo_alterar_id_cliente").val()>0){$.post("/pf/DIM.Gateway.php",{i:$(this).val(),arq:59,tch:1,sub:0,dlg:1},function(a){$("#fmiacli_info").css({visibility:"visible"});if(a.logomarca!==null){$("#fmiacli_span_logomarca").html('<img src="/pf/vendor/cropper/producao/crop/img/img-cli/'+a.logomarca+".png?"+new Date().getTime()+'" class="img-thumbnail" width="150" height="150">')}else{$("#fmiacli_span_logomarca").html('<img src="/pf/img/blank_logo.pt_BR.jpg" class="img-thumbnail img-responsive" width="150" height="150">')}$("#fmiacli_span_descricao").html(a.descricao);$("#fmiacli_span_nome").html(a.nome);$("#fmiacli_span_email").html('<a href="mailto:'+a.email+'">'+a.email+"</a>");$("#fmiacli_span_telefone").html(a.telefone);a.is_ativo==1?$("#div-txt-cliente").html("Atualmente o cliente est&aacute; <kbd>ativo</kbd>"):$("#div-txt-cliente").html("Atualmente o cliente est&aacute; <kbd>inativo</kbd>")},"json");$("#fmiacli_btn_alterar").prop("disabled",empresaConfigPlano.id==3?false:true)}else{$("#fmiacli_info").css({visibility:"hidden"});$("#fmiacli_span_logomarca").html('<img src="/pf/img/blank_logo.pt_BR.jpg" class="img-thumbnail img-responsive" width="150" height="150">');$("#fmiacli_span_nome").html("--");$("#fmiacli_span_email").html("--");$("#fmiacli_span_telefone").html("--");$("#fmiacli_btn_alterar").prop("disabled",true);$("#div-txt-cliente").html("")}});$("#fmiacli_btn_alterar").on("click",function(){var a=$("#combo_alterar_id_cliente").val();if(a>0){$("#fmiacli_acao").val("alterar");$.post("/pf/DIM.Gateway.php",{i:a,arq:59,tch:1,sub:0,dlg:1},function(b){$("#fmiacli_id").val(b.id);$("#fmiacli_descricao").val(b.descricao);$("#fmiacli_is_ativo").bootstrapToggle(b.is_ativo==1?"on":"off");$("#fmiacli_sigla").val(b.sigla);$("#fmiacli_nome").val(b.nome);$("#fmiacli_email").val(b.email);$("#fmiacli_nome2").val(b.nome2);$("#fmiacli_email2").val(b.email2);$("#fmiacli_telefone").val(b.telefone);$("#fmiacli_telefone2").val(b.telefone2);$("#fmiacli_ramal").val(b.ramal==0?"":b.ramal);$("#fmiacli_ramal2").val(b.ramal2==0?"":b.ramal2);$("#fmiacli_uf").val(b.uf);$("#fmiacli_btn_novo").prop("disabled",true);$("#fmiacli_btn_inserir").prop("disabled",true);$("#fmiacli_btn_atualizar").prop("disabled",false);$("#avatar-frame-cli").contents().find("#avatar_id").val(b.id);if(b.logomarca!==null){$("#avatar-frame-cli").contents().find("#avatar_img").attr("src","/pf/vendor/cropper/producao/crop/img/img-cli/"+b.logomarca+".png?"+new Date().getTime())}else{$("#avatar-frame-cli").contents().find("#avatar_img").attr("src","/pf/img/blank_logo.pt_BR.jpg")}},"json")}});function limpaCamposCliente(){$("#fmiacli_id").val("");$("#fmiacli_acao").val("inserir");$("#fmiacli_descricao").val("");$("#fmiacli_is_ativo").bootstrapToggle("on");$("#fmiacli_sigla").val("");$("#fmiacli_nome").val("");$("#fmiacli_email").val("");$("#fmiacli_nome2").val("");$("#fmiacli_email2").val("");$("#fmiacli_telefone").val("");$("#fmiacli_telefone2").val("");$("#fmiacli_ramal").val("");$("#fmiacli_ramal2").val("");$("#fmiacli_uf").val(0);$("#fmiacli_btn_novo").prop("disabled",true);$("#fmiacli_btn_inserir").prop("disabled",false);$("#fmiacli_btn_atualizar").prop("disabled",true);$("#avatar-frame-cli").attr("src","/pf/vendor/cropper/producao/crop/index.php?t=cli");$("#fmiacli-i-captcha").removeClass("fa-check-circle").addClass("fa-dot-circle-o");$("#fmiacli-txt-captcha").val("");dataFormCliente={}}$("#fmiacli-link").on("click",function(){if(isFornecedor){return false}else{$(this).attr({"data-toggle":"modal","data-target":"#form_modal_inserir_cliente"})}});function variaveisFormCliente(a){dataFormCliente={acao:a,id:$("#fmiacli_id").val(),id_empresa:idEmpresa,is_ativo:$("#fmiacli_is_ativo").prop("checked")?1:0,descricao:$("#fmiacli_descricao").val(),sigla:$("#fmiacli_sigla").val(),nome:$("#fmiacli_nome").val(),email:$("#fmiacli_email").val(),nome2:$("#fmiacli_nome2").val(),email2:$("#fmiacli_email2").val(),telefone:$("#fmiacli_telefone").val(),telefone2:$("#fmiacli_telefone2").val(),ramal:$("#fmiacli_ramal").val(),ramal2:$("#fmiacli_ramal2").val(),uf:$("#fmiacli_uf").val(),captcha:$("#fmiacli_captcha").val(),arq:44,tch:0,sub:0,dlg:1};return dataFormCliente};